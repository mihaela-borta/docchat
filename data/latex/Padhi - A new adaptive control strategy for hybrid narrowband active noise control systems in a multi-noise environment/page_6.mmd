* A feedback ANC system whose primary objective is to mitigate the uncorrelated disturbances in the ANC system.

The coefficients of the feedforward controller are adapted by the FXWALMS algorithm with a new value of the variable momentum factor. Additionally, in the proposed HNANC system, the feedforward controller requires only two x-filtering blocks whose output is decomposed by an efficient bandpass filter bank whose transfer functions are derived in [34, 35]. The bandpass filterbank cell is generated by a north filter with the entities poles and zeros being constrained [36]. The new design allows a lot of flexibility in the design of a HNANC system because of significantly low computational cost. The block diagram in Fig. 4 gives the output signal of the FNC subsystem as

\[y_{\text{src}}(k)=\sum_{i=1}^{l}y_{c,i}(k)=\sum_{i=1}^{l}\Big{\{}\hat{\alpha}_ {c,i}(k)\kappa_{\text{x}_{\text{x}_{\text{x}_{\text{x}_{\text{x}_{\text{x}_{ \text{x}_{\text{x}_{\text{x}_{\text{x}_{\text{x}_{\text{x}_{\text{x}_{\text{x}}}}}}}}}}}}}}(k)+ \hat{b}_{c,i}(k)\kappa_{\text{x}_{\text{x}_{\text{x}_{\text{x}_{\text{x}_{ \text{x}_{\text{x}_{\text{x}_{\text{x}_{\text{x}_{\text{x}}}}}}}}}}}(k)} \Big{\}}. \tag{28}\]

The error signal of the FNC subsystem is obtained as

\[\epsilon_{\text{ffx}}(k)=e(k)-y_{\text{src}}(k). \tag{29}\]

Using (22) in the above equation, we get

\[\epsilon_{\text{ffx}}(k)=p(k)-y_{p}(k)+d(k)-y_{d}^{\prime}(k)-y_{\text{src}}(k). \tag{30}\]

The DFC coefficients of the FNC subsystem are updated as

\[\hat{a}_{c,i}(k+1)=\hat{a}_{c,i}(k)+\mu_{t}\epsilon_{\text{ffx}}(k)\kappa_{ \text{x}_{\text{x}_{\text{x}_{\text{x}_{\text{x}_{\text{x}_{\text{x}_{\text{x }_{\text{x}}}}}}}}}(k)}, \tag{31}\]

\[\hat{b}_{c,j}(k+1)=\hat{b}_{c,j}(k)+\mu_{t}\epsilon_{\text{ffx}}(k)\kappa_{ \text{x}_{\text{x}_{\text{x}_{\text{x}_{\text{x}_{\text{x}_{\text{x}_{\text{x }_{\text{x}}}}}}}}}(k)}, \tag{32}\]

where \(\mu_{c,i}\) is the step-size, are reference signals, which are correlated with \(y_{p}(k)\) and \(\epsilon_{\text{ffx}}(k)\) containing portions of \(p(k)\). Since the DFC coefficients of the FNC subsystem are adapted by \(\kappa_{\text{x}_{\text{x}}}(k)\) and \(\kappa_{\text{x}_{\text{x}}}(k)\), reducing the error \(\epsilon_{\text{ffx}}(k)\) means that \(y_{\text{ffx}}(k)\) converges to that part of (30) which is correlated with the reference input and hence \[y_{\text{ffx}}(k)\rightharpoonup\Big{[}p(k)-y_{p}^{\prime}(k)\Big{]},\] (33)

and therefore \(\epsilon_{\text{ffx}}(k)\) converges to the other part of which is uncorrelated

\[\epsilon_{\text{ffx}}(k)\rightharpoonup[d(k)-\hat{y}_{d}(k)]. \tag{34}\]

On comparing (33) to (22) we can conclude that \(y_{\text{ffx}}(k)\) is the most appropriate error signal for the feedforward controller for optimal ANC performance. Now, we use this error signal to modify the cost function for the FXWALMS algorithm to update the DFCs of the feedforward ANC controller. The modified cost function is given as

\[J\Big{(}k,\hat{a},\hat{b}_{i}\Big{)}=\sum_{j=1}^{k}\lambda_{i}^{k-j}y_{\text{ ffx}}^{2}(j), \tag{35}\]

where \(y_{\text{ffx}}(j)\) is the instantaneous error in time for the feedforward NANC system in time \(j\), and \(\lambda_{i}\) is called the variable momentum factor which is adjusted by using the energy of the instantaneous output of the FNC subsystem as

\[\lambda_{i}(k)=\chi_{j}\hat{a}(k-1)+\hat{a}y_{\text{ffx}}^{2}(k), \tag{36}\]

where \(0<\chi_{i}<1\) and \(0<\delta_{i}\) are used for optimal algorithm performance [21], Now, by using the steepest descent algorithm to update the DFCs of the feedforward controller, we get

\[\hat{a}_{i}(k+1)=\hat{a}_{i}(k)-0.5\mu_{t}\Delta_{\text{ij}}J\Big{(}k,\hat{a}_ {i},\hat{b}_{i}\Big{)}, \tag{37}\]

and

\[\hat{b}_{i}(k+1)=\hat{b}_{i}(k)-0.5\mu_{t}\Delta_{\text{ij}}J\Big{(}k,\hat{a}_ {i},\hat{b}_{i}\Big{)}. \tag{38}\]

where \(\Delta_{\text{ij}}J\Big{(}k,\hat{a}_{i},\hat{b}_{i}\Big{)}\) and \(\Delta_{\text{ij}}J\Big{(}k,\hat{a}_{i},\hat{b}_{i}\Big{)}\) are the gradient values at time instant \(k\). Now, using (33) and (35), we get

\[\Delta_{\text{ij}}J\Big{(}k,\hat{a},\hat{b}_{i}\Big{)}=\sum_{j=1}^{k}\lambda_{i }(k-j)\frac{\partial y_{\text{ffx}}^{2}}{\partial\hat{a}_{i}}=-2\sum_{j=1}^{k} \lambda_{i}^{k-j}y_{\text{ffx}}(j)\hat{\kappa}_{\text{x}_{\text{x}}}(j), \tag{39}\]

\[\Delta_{\text{ij}}J\Big{(}k,\hat{a},\hat{b}_{i}\Big{)}=\sum_{j=1}^{k}\lambda_{i }(k-j)\frac{\partial y_{\text{ffx}}^{2}}{\partial\hat{b}_{i}}=-2\sum_{j=1}^{k} \lambda_{i}^{k-j}y_{\text{ffx}}(j)\hat{\kappa}_{\text{x}_{\text{x}}}(j). \tag{40}\]

Using (39) and (40) in (37) and (38) respectively, we get

\[\hat{a}_{i}(k+1)=\hat{a}_{i}(k)+\mu_{j}y_{\text{ffx}}(k)\hat{\kappa}_{\text{x} _{\text{x}_{\text{x}_{\text{x}}}}}(k)+\mu_{j}\sum_{j=1}^{k-1}\lambda_{i}^{k-j}y_{ \text{ffx}}(j)\hat{\kappa}_{\text{x}_{\text{x}}}(j) \tag{41}\]

\[\hat{b}_{i}(k+1)=\hat{b}_{i}(k)+\mu_{j}y_{\text{ffx}}(k)\hat{\kappa}_{\text{x} _{\text{x}_{\text{x}_{\text{x}_{\text{x}_{\text{x}}}}}}}(k)+\mu_{j}\sum_{j=1}^{k-1} \lambda_{i}^{k-j}y_{\text{ffx}}(j)\hat{\kappa}_{\text{x}_{\text{x}}}(j) \tag{42}\]

Similarly, using (37)-(40), to deduce the adaptive filter weights at \(k\)th, and doing some rearrangements, we obtain

\[\lambda_{i}[\hat{a}_{i}(k)-\hat{a}_{i}(k-1)]=\mu_{j}\left[\sum_{j=1}^{k-1}\lambda_ {i}^{k-j}y_{\text{ffx}}(j)\hat{\kappa}_{\text{x}_{\text{x}_{\text{x}}}}(j) \right], \tag{43}\]

\[\lambda_{i}\Big{[}\hat{b}_{i}(k)-\hat{b}_{i}(k-1)\Big{]}=\mu_{j}\left[\sum_{j=1}^{k -1}\lambda_{i}^{k-j}y_{\text{ffx}}(j)\hat{\kappa}_{\text{x}_{\text{x}_{\text{x}}}}(j) \right]. \tag{44}\]

Now, replacing (43) and (44) in (41) and (42), we get the new iterative formula for updating the DFCs of the feedforward controller using the FXWALMS algorithm with the new variable momentum factor \(\lambda_{i}(k)\) as

\[\hat{a}_{i}(k+1)=\hat{a}_{i}(k)+\mu_{j}y_{\text{ffx}}(k)\hat{\kappa}_{\text{x}_{ \text{x}}}(k)+\lambda_{i}(k)[\hat{a}_{i}(k)-\hat{a}_{i}(k-1)], \tag{45}\]

\[\hat{b}_{i}(k+1)=\hat{b}_{i}(k)+\mu_{j}y_{\text{ffx}}(k)\hat{\kappa}_{\text{x}_{ \text{x}}}(k)+\lambda_{i}(k)\Big{[}\hat{b}_{i}(k)-\hat{b}_{i}(k-1)\Big{]}. \tag{46}\]

In the above update equations and from Fig. 4 the input/output signals are given as

\[\kappa_{\text{x}}(k)=\sum_{i=1}^{l}\lambda_{\text{x}_{\text{x}_{\text{x}_{\text{x}}}}}(k), \tag{47}\]

\[\kappa_{\text{x}_{\text{b}}}(k)=\sum_{i=1}^{l}\lambda_{\text{x}_{\text{x}_{\text{b}}}}(k). \tag{48}\]

The reference input filtered through the secondary path is given as

\[\hat{\kappa}_{\text{a}}(k)=\sum_{i=1}^{l}\hat{\kappa}_{\text{x}_{\text{a}_{\text{x}}}}(k