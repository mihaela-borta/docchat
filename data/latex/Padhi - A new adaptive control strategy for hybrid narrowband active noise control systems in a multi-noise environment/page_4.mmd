There are various methods for secondary path identification and a few of the popular methods are offline and online secondary path modeling techniques are given in [29, 30, 31, 32, 33, 28]. In a multi-noise environment, there are circumstances where the NANC system is simultaneously affected by correlated, uncorrelated and narrowband sinusoidal interferences. The modeling of uncorrelated and sinusoidal interferences has been a bigger challenge in the design of ANC systems for industrial applications. To model the uncorrelated and low-frequency components of the noise, the error signal \(e(k)\) is modified as

\[e(k)=p(k)-y_{s}(k)+d(k), \tag{15}\]

where \(d(k)\) contains the uncorrelated narrowband disturbances and sinusoidal interferences, often termed as "Firework Noise". Upon this modification of the residual noise, the updating equations of the FXLMS algorithms also get modified. Now, using (15) in (8) and (9), we get

\[\hat{a}_{i}(k+1)=\hat{a}_{i}(k)+\mu_{i}[p(k)-y_{s}(k)\hat{x}_{\alpha_{i}}(k)+ \mu_{i}d(k)\hat{x}_{\alpha_{i}}(k), \tag{16}\]

and

\[\hat{b}_{i}(k+1)=\hat{b}_{i}(k)+\mu_{i}[p(k)-y_{s}(k)\hat{x}_{\alpha_{i}}(k)+ \mu_{i}d(k)\hat{x}_{\alpha_{i}}(k). \tag{17}\]

On comparing the above equations with (8) and (9), we can clearly observe that the adaptation process is perturbed by the additive sinusoids and uncorrelated disturbances which are modeled by \(d(k)\) and there is a considerable performance degradation of the NANC system.

## 3 A solution with HNANC systems

Upon carefully observing Fig. 3 wherein a HNANC system is depicted, it can be seen that the design is based on the combination of a feedforward NANC system and a conventional feedback ANC system. The feedback ANC in a HNANC system has the functionality of mitigating the uncorrelated disturbances which significantly decreases the residual error. As can be observed from the block diagram in Fig. 3, the output of the HNANC system is given by

\[\begin{array}{ll}y(k)&=y_{p}(k)+y_{a}(k)\\ &=y_{p}(k)+w_{a}^{2}(k)d^{\prime}(k),\end{array} \tag{18}\]

where \(y_{p}(k)\) is the output of the NANC subsystem computed by (2) and the adaptive filter \(\mathbf{w}_{b}(k)=[w_{b_{1}}(k),w_{b_{1}}(k-1),\dots,\)\(w_{b_{k,i}}(k-L+1)]^{T}\) and the internally generated reference signal for the feedback part is \(\mathbf{d}^{\prime}(k)=[d^{\prime}(k),d(k-1),\dots,d(k-L+1)]^{T}\), with \(L\) being the length of the adaptive filter \(W_{b}(z)\). The reference signal \(\mathbf{d}^{\prime}(k)\) is internally generated by the HNANC system as

\[\hat{d}^{\prime}(k)=e(k)+y(k)*\hat{s}(k). \tag{19}\]

Now, the error signal \(e(k)\) is given by

\[\begin{array}{ll}e(k)&=p(k)+d(k)-y_{s}(k)\\ &=p(k)+d(k)-y(k)*\hat{s}(k).\end{array} \tag{20}\]

Substituting (20) to (19) and assuming \(S(z)\equiv\hat{S}(z)\),

\[\hat{d}(k)=p(k)-y(k)*\hat{s}(k)+y(k)*\hat{s}(k)\quad\approx p(k)+d(k). \tag{21}\]

Now, substituting (21) to (18) we get

\[\begin{array}{ll}e(k)&=p(k)-y_{p}(k)*\hat{s}(k)-y_{a}(k)*\hat{s}(k)\\ &=p(k)-y_{p}^{*}(k)+d(k)-y_{a}^{*}(k).\end{array} \tag{22}\]

Now, we define \(e_{\prime}(k)=p(k)-y_{p}(k)\), and \(e_{b}(k)=d(k)-y_{b}(k)\). Then (22) becomes

\[e(k)=e_{b}(k)+e_{\prime}(k). \tag{23}\]

Now using the FXLMS for updating the control filter in the feedback part \(W_{b}(z)\), we get

\[\mathbf{w}_{b}(k+1)=\mathbf{w}_{b}(k)+\mu_{w}e(k)\hat{\mathbf{d}^{\prime}}(k), \tag{24}\]

where the step size of the adaptive filter is given by \(\mu_{w}\) and \(\hat{\mathbf{d}^{\prime}}(k)\) is the input signal is filtered by secondary path estimate as

Figure 3: Block diagram of a HNANC (th channel).